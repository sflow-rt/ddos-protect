<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="../../../inc/img/favicon.png">
    <link rel="stylesheet" href="../../../inc/bootstrap.min.css">
    <link rel="stylesheet" href="../../../inc/stripchart.css">
    <link rel="stylesheet" href="css/app.css">
    <script type="text/javascript" src="../../../inc/jquery.min.js"></script>
    <script type="text/javascript" src="../../../inc/jquery.widget.js"></script>
    <script type="text/javascript" src="../../../inc/jquery.stripchart.js"></script>
    <script type="text/javascript" src="../../../inc/stripchart.js"></script>
    <script type="text/javascript" src="../../../inc/popper.min.js"></script>
    <script type="text/javascript" src="../../../inc/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <title>DDoS Protect</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-sm navbar-dark mb-3" style="background-color: #336;">
      <a class="navbar-brand" href="#">
        <img src="../../../inc/img/inmon.svg" height="30" class="d-inline-block align-top">
        DDoS Protect
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item" data-toggle="collapse" data-target=".navbar-collapse.show">
            <a class="nav-link" href="#charts">Charts</a>
          </li>
          <li class="nav-item" data-toggle="collapse" data-target=".navbar-collapse.show">
            <a class="nav-link" href="#controls">Controls</a>
          </li>
          <li class="nav-item" data-toggle="collapse" data-target=".navbar-collapse.show">
            <a class="nav-link" href="#settings">Settings</a>
          </li>
          <li class="nav-item" data-toggle="collapse" data-target=".navbar-collapse.show">
            <a class="nav-link" href="#help">Help</a>
          </li>
        </ul>
      </div>
    </nav>
    <main class="container-fluid" role="main">
      <section id="charts">
        <div class="row">
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">ip_flood<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="ip-flood" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">ip_fragmentation<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="ip-fragmentation" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">icmp_flood<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="icmp-flood" class="trend"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">udp_flood<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="udp-flood" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">udp_amplification<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="udp-amplification" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">tcp_flood<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="tcp-flood" class="trend"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">tcp_amplification<a href="#" class="badge badge-light float-right"><img src="img/barchart-fill.svg"></a></h5>
              <div class="card-body">
                <div id="tcp-amplification" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">Controls</h5>
              <div class="card-body">
                <div id="attacks" class="trend"></div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card mb-3">
              <h5 class="card-header">BGP</h5>
              <div class="card-body">
                <div id="connections" class="trend"></div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section id="controls" class="container">
        <div class="table-responsive-xl">
          <table id="controlstable" class="table table-bordered table-sm table-hover">
            <thead class="thead-light">
              <tr>
                <th>Target</th>
                <th>Group</th>
                <th>Attack</th>
                <th>Protocol</th>
                <th>Time</th>
                <th>Action</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
        <div class="modal fade" id="control-dialog" tabindex="-1" role="dialog">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Modify Control</h5>
                <button type="button" class="close" data-dismiss="modal">
                  <span>&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-4 text-right font-weight-bold">Target</div>
                  <div class="col-8" id="control-target"></div>
                </div>
                <div class="row">
                  <div class="col-4 text-right font-weight-bold">Group</div>
                  <div class="col-8" id="control-group"></div>
                </div>
                <div class="row">
                  <div class="col-4 text-right font-weight-bold">Attack</div>
                  <div class="col-8" id="control-attack"></div>
                </div>
                <div class="row">
                  <div class="col-4 text-right font-weight-bold">Protocol</div>
                  <div class="col-8" id="control-protocol"></div>
                </div>
                <div class="row">
                  <div class="col-4 text-right font-weight-bold">Action</div>
                  <div class="col-8" id="control-action"></div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="control-remove">Remove</button>
                <button type="button" class="btn btn-primary" id="control-install">Install</button>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section id="settings" class="container">
        <div class="card mb-3">
          <div class="card-header">Controller Mode</div>
          <div class="card-body">
            <form>
              <div class="form-group" id="mode">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="controller_mode" id="automatic" value="automatic">
                  <label class="form-check-label" for="inlineRadio1">Automatic</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="controller_mode" id="manual" value="manual">
                  <label class="form-check-label" for="manual">Manual</label>
                </div>
              </div>
            </form>
            <p>Automatic mode allows the controller to install controls without operator action.
             Manual mode requires confirmation before controls are installed.</p>
            </div>
          </div>
        </div>
        <div class="card mb-3">
          <div class="card-header">Attack Mitigation</div>
          <div class="card-body">
            <div class="table-responsive-md">
              <table id="settingstable" class="table table-bordered table-hover table-sm">
                <thead class="thead-light">
                  <tr>
                    <th scope="col">Attack</th>
                    <th scope="col">Action</th>
                    <th scope="col">Threshold</th>
                    <th scope="col">Timeout</th>
                    <th scope="col">Include</th>
                    <th scope="col">Exclude</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">ip_flood</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">ip_fragmentation</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">icmp_flood</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">udp_flood</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">udp_amplification</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">tcp_flood</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <th scope="row">tcp_amplification</th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Click on rows in the table to change attack mitigation settings: threshold (in packets per second) to trigger control action,
            timeout (in Minutes) before removing action, and action type (ignore, drop, filter, mark, limit, redirect, community).</p>
            <div class="modal fade" id="setting-dialog" tabindex="-1" role="dialog">
              <form>
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Settings: <span id="setting-attack"></span></h5>
                      <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                      </button>
                   </div>
                   <div class="modal-body">
                     <div class="form-group row">
                       <div class="col-4 col-form-label text-right font-weight-bold">Action</div>
                       <div class="col-8">
                         <select id="setting-action" class="form-control">
                           <option>ignore</option>
                           <option>drop</option>
                           <option>filter</option>
                           <option>mark</option>
                           <option>limit</option>
                           <option>redirect</option>
                           <option>community</option>
                         </select>
                       </div>
                     </div>
                     <div class="form-group row">
                       <div class="col-4 col-form-label text-right font-weight-bold">Threshold</div>
                       <div class="col-8"><input type="number" min="0" id="setting-threshold" class="form-control"></input></div>
                     </div>
                     <div class="form-group row">
                       <div class="col-4 col-form-label text-right font-weight-bold">Timeout</div>
                       <div class="col-8"><input type="number" min="0" id="setting-timeout" class="form-control"></input></div>
                     </div>
                     <div class="form-group row">
                       <div class="col-4 col-form-label text-right font-weight-bold">Include</div>
                       <div class="col-8"><input type="text" id="setting-include" class="form-control" placeholder="List of protocols"></input></div>
                     </div>
                     <div class="form-group row">
                       <div class="col-4 col-form-label text-right font-weight-bold">Exclude</div>
                       <div class="col-8"><input type="text" id="setting-exclude" class="form-control" placeholder="List of protocols"></input></div>
                     </div>
                   </div>
                   <div class="modal-footer">
                     <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                     <button type="button" class="btn btn-primary" id="setting-submit">Submit</button>
                   </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="card mb-3"">
          <div class="card-header">Address Groups</div>
          <div class="card-body">
            <table id="groupstable" class="table table-bordered table-hover table-sm">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Group</th>
                  <th scope="col">CIDRs</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
            <form class="form-inline">
              <div class="form-group mx-sm-3 mb-3">
                <input type="text" class="form-control" id="group-name" placeholder="Group Name">
              </div>
              <button type="button" class="btn btn-primary mb-3" id="group-create" disabled>Create Group</button>
            </form> 
            <p>Click on rows in the table to remove group or edit comma separated list of CIDRs.</p>
            </div>
          </div>
          <div class="modal fade" id="group-dialog" tabindex="-1" role="dialog">
            <form>
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title">Group: <span id="group-name"></span></h5>
                    <button type="button" class="close" data-dismiss="modal">
                      <span>&times;</span>
                    </button>
                 </div>
                 <div class="modal-body">
                   <div class="form-group">
                     <textarea class="form-control" id="group-cidrs" rows="3"></textarea>
                   </div>
                 </div>
                 <div class="modal-footer">
                   <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                   <button type="button" class="btn btn-primary" id="group-delete">Delete</button>
                   <button type="button" class="btn btn-primary" id="group-submit">Submit</button>
                 </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </section>
      <section id="help" class="container">

        <h3>About</h3>
        <p>DDoS Protect is a real-time distributed denial of service (DDoS) detection and mitigation application
         using the <a href="https://sflow-rt.com/">sFlow-RT</a> real-time analytics engine. The software receives
         a continuous stream of telemetry from standard <a href="https://sflow-rt.com/agents.php">sFlow agents</a>
         embedded in network devices, detects DDoS attacks, and pushes BGP remote triggered blackhole (RTBH) or
         Flowspec messages to block the attack upstream.</p>
        <h3>Getting Started</h3>
        <p>The following steps are required:</p>
        <ol>
          <li>Configure sFlow</li>
          <li>Configure BGP</li>
          <li>Group address space</li>
          <li>Set mitigation policy</li>
        </ol>
        <p>Once configuration is complete, the <em>Charts</em> tab will display candidate DDoS traffic.
        If the charts show zero traffic, verify that sFlow data is being received and that traffic groups
        are correctly defined. The <em>BGP</em> chart can be used to verify that the BGP connection has
        been established.</p>

        <h4>Configure sFlow</h4>
        <p><a href="https://blog.sflow.com/2012/09/switch-configurations.html">Switch configurations</a>
        contains a repository of links describing how to configure sFlow on different vendor's switches.
        Use the <a href="../../../html/" onclick="window.sessionStorage.setItem('nav','status')">sFlow-RT Status</a>
        tab to verify that sFlow telemetry is being received.</p>

        <h4>Configure BGP</h4>
        <p>Configure <em>Startup Settings</em> to enable BGP and ensure settings match those that
        will be configured on router(s).  Configure site router(s) (or route reflector) to establish a BGP connection
        to controller on TCP port 1179. Use the <em>BGP</em> chart under the <em>Charts</em> tab to verify
        the connection(s).</p>
        <p>If the router cannot be configured to connect to the non-standard 1179 BGP port then additional operating
        system privileges need to be assigned to the sFlow-RT daemon so that port 179 can be opened.</p>
        <h5>Docker</h5>
        <p>Using the <a href="https://hub.docker.com/r/sflow/ddos-protect">sflow/ddos-protect</a> image:</p>
        <pre class="bg-light"><code>docker run --net=host \
-v $PWD/ddos.conf:/sflow-rt/ddos.conf \
sflow/ddos-protect -Dsystem.propertyFiles=ddos.conf -Dbgp.port=179</code></pre>
        <h5>Systemd</h5>
        <p>Edit the sflow-rt service</p>
        <pre class="bg-light"><code>sudo systemctl edit sflow-rt.service</code></pre>
        <p>Add the following statements:</p>
        <pre class="bg-light"><code>[Service]
AmbientCapabilities=CAP_NET_BIND_SERVICE</code></pre>
        <p>Edit the ddos-protect configuration file:</p>
        <pre class="bg-light">sudo vi /usr/local/sflow-rt/conf.d/ddos-protect.conf</code></pre>
        <p>Add the line:</p>
        <pre class="bg-light">bgp.port=179</code></pre>
        <p>Restart sFlow-RT:</p>
        <pre class="bg-light">sudo systemctl restart sflow-rt.service</code></pre>

        <h4>Group Address Space</h4>
        <table class="table table-bordered table-sm">
          <thead class="thead-light">
            <tr>
              <th scope="col">Group</th>
              <th scope="col">CIDRs</th>
            </tr>
          </thead>
          <tbody>
            <tr class="table-danger">
              <td>external</td>
              <td class="text-wrap">0.0.0.0/0, ::/0</td>
            </tr>
            <tr class="table-success">
              <td>private</td>
              <td class="text-wrap">10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16, fc00::/7</td>
            </tr>
            <tr class="table-success">
              <td>multicast</td>
              <td class="text-wrap">224.0.0.0/4, ff00::/8</td>
            </tr>
            <tr class="table-success">
              <td>exclude</td>
              <td class="text-wrap">192.0.2.0/24</td>
            </tr>
            <tr class="table-warning">
              <td>servers</td>
              <td class="text-wrap">192.0.2.128/25</td>
            </tr>
          </tbody>
        </table>
        <p>The example above lists the public address space allocated to the site in the <em>exclude</em> group,
        which by default prevents these addresses (along with addresses in the <em>private</em>, <em>multicast</em>,
        and <em>external</em> groups), from being mitigation candidates. Any additional groups are candidates for
        mitigation in the case of a DDoS attack, in this case the <em>servers</em> group with CIDR 192.0.2.128/25.</p>
        <p><strong>Note</strong> At least one candidate group must be defined before traffic will be shown under the
        <em>Charts</em> tab.</p>
        <p>Alternatively, local / non-local address space can be discovered through BGP:</p> 
        <ol>
          <li>Enable export of BGP data in the sFlow configuration on routers that support the sFlow <em>extended_gateway</em> feature</li>
          <li>Otherwise, use the <code>ddos_protect.router.&lt;N&gt;.agent</code> setting to lookup route information from the BGP feed</li>
        </ol>
        <p>Once BGP route information is being received, the <code>ddos_protect.bgpgroup=site</code> setting enables classification
        of traffic based on the learned routes, assigning local addresses to the <em>site</em> group. Excluded groups are honored
        and additional groups will be used to label traffic, but will not affect determination of site addresses.</p>
         

        <h4>Set Mitigation Policy</h4>
        <p>The following volumetric DDoS attack types can be detected:</p>
        <div class="table-responsive-sm">
          <table class="table table-bordered table-sm table-striped">
            <thead class="thead-light">
              <tr><th>Attack</th><th>Description</th></tr>
            </thead>
            <tbody>
              <tr><th>ip_flood</th><td>IP packets by target address and protocol</tr>
              <tr><th>ip_fragmentation</th><td>IP fragments by target address and protocol</tr>
              <tr><th>icmp_flood</th><td>ICMP packets by target address and type</td></tr>
              <tr><th>udp_flood</th><td>UDP packets by target address and destination port</em></tr>
              <tr><th>udp_amplification</th><td>UDP packets by target address and source port</td></tr>
              <tr><th>tcp_flood</th><td>TCP packets by target address and destination port</td></tr>
              <tr><th>tcp_amplification</th><td>TCP SYN-ACK packets by target address and source port</td></tr>
            <tbody>
          </table>
        </div>
        <p>For each attack type, select a mitiation action:</p>
        <div class="table-responsive-md">
          <table class="table table-bordered table-sm table-striped">
            <thead class="thead-light">
              <tr><th>Action</th><th>Description</th></tr>
            </thead>
            <tbody>
              <tr><th>ignore</th><td>Ignore, don't create control</tr>
              <tr><th>drop</th><td>Remote triggered black hole (RTBH) dropping all traffic to targetted address</tr>
              <tr><th>filter</th><td>Flowspec rule dropping traffic matching protocol, port and target address</tr>
              <tr><th>mark</th><td>Flowspec rule setting DSCP for traffic matching protocol, port and target address</td></tr>
              <tr><th>limit</th><td>Flowspec rule rate limitting traffic matching protocol, port and target address</td></tr>
              <tr><th>redirect</th><td>Flowspec rule redirecting traffic matching protocol, port and target address</td></tr>
              <tr><th>community</th><td>Flowspec rule setting community for traffic matching protocol, port and target address</td></tr>
            <tbody>
          </table>
        </div>
        <p>For each attack type, set a threshold (in Packets per Second) that will trigger the specified action. Actions
        are automatically removed after the specified timeout (in Minutes), unless the attack traffic is still above the
        threshold level.</p>
        <p>Set the <em>Controller Mode</em> to <em>Manual</em> if you want to confirm control actions before they
        installed. Click on a row in the <em>Controls</em> table to manually <em>Remove</em> or <em>Install</em> the
        control.</p>

        <h3>Monitoring</h3>
        <p>Integration is provided with external monitoring systems:</p>
        <ul>
        <li><strong>Events</strong> are logged every time a new attack is detected. These events can be forwarded using the <em>syslog</em> protocol. Configure <em>ddos_protect.syslog.host</em> to specify a comma separated list of log collector IP addresses.</li>
        <li><strong>Metrics</strong> are <a href="../scripts/ddos.js/prometheus/txt">published</a> using the Prometheus export format. Configure metrics database to periodically request current values.</li> 
        </ul>

        <h3>Startup Settings</h3>
        <p>See <a href="https://sflow-rt.com/reference.php#properties">System Properties</a> for information on configuring startup settings.</p>
        <div class="table-responsive-xl">
          <table class="table table-striped table-bordered table-sm">
            <thead class="thead-light"><tr><th>Property</th><th>Default</th><th>Description</th></tr><thead>
            <tbody>
              <tr><td>bgp.start</td><td>no</td><td>Start BGP listener</td></tr>
              <tr><td>bgp.port</td><td>1179</td><td>TCP port used to listen for BGP connections</td></tr>
              <tr><td>ddos_protect.router</td><td>127.0.0.1</td><td>Comma separated list of BGP router IP addresses making connections</td></tr>
              <tr><td>ddos_protect.router.&lt;N&gt;.agent</td><td></td><td>Use Nth (starting at 0) router to lookup BGP routes for comma separated list of agents</td></tr> 
              <tr><td>ddos_protect.as</td><td>65000</td><td>Local AS number to advertise to router(s)</td></tr>
              <tr><td>ddos_protect.id</td><td>0.6.6.6</td><td>Local identifier to advertise to router(s)</td></tr>
              <tr><td>ddos_protect.community</td><td>65535:666</td><td>BGP community used to identify blackhole routes</td></tr>
              <tr><td>ddos_protect.nexthop</td><td>192.0.2.1</td><td>BGP next hop used to identify blackhole routes</td></tr> 
              <tr><td>ddos_protect.nexthop6</td><td>100::1</td><td>BGP IPv6 next hop used ot identify blackhole routes</td></tr>
              <tr><td>ddos_protect.localpref</td><td>100</td><td>BGP local preference used to identify blackhole routes</td></tr>
              <tr><td>ddos_protect.enable.ipv6</td><td>no</td><td>BGP enable IPv6 addresses</td></tr>
              <tr><td>ddos_protect.enable.flowspec</td><td>no</td><td>BGP enable Flowspec IPv4 rules</td></tr>
              <tr><td>ddos_protect.enable.flowspec6</td><td>no</td><td>BGP enable Flowspec IPv6 rules</td></tr>
              <tr><td>ddos_protect.flowspec.dscp</td><td>le</td><td>BPG Flowspec DSCP value for marking traffic</td></tr>
              <tr><td>ddos_protect.flowspec.rate</td><td>12500</td><td>BGP Flowspec rate (in Bytes per Second) for rate limited traffic</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.method</td><td>as</td><td>BGP Flowspec redirect method: <em>as</em>, <em>as4</em>, <em>ip</em>, <em><a href="https://tools.ietf.org/html/draft-simpson-idr-flowspec-redirect-02">nexthop</a></em>, <em><a href="https://tools.ietf.org/html/draft-ietf-idr-flowspec-redirect-ip-02">ipaction</a></em></td></tr>
              <tr><td>ddos_protect.flowspec.redirect.as</td><td>65000:666</td><td>BGP Flowspec redirect VRF 2-octet AS, 4-octet value</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.as4</td><td>65000:666</td><td>BGP Flowspec redirect VRF 4-octet AS, 2-octet value</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.ip</td><td>192.0.2.1:666</td><td>BGP Flowspec redirect VRF IPv4 address, 2-octet value</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.nexthop</td><td>192.0.2.1</td><td>BGP Flowspec redirect next-hop for IPv4 flows</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.nexthop6</td><td>100::1</td><td>BGP Flowspec redirect next-hop for IPv6 flows</td></tr>
              <tr><td>ddos_protect.flowspec.redirect.ipaction</td><td>192.0.2.1</td><td>BGP Flowspec redirect IPv4 next-hop action</td></tr>
              <tr><td>ddos_protect.flowspec.community</td><td>128:6:0</td><td>BGP Flowspec community</td></tr>
              <tr><td>ddos_protect.maxroutes</td><td>1000</td><td>Maximum number of blackhole routes allowed</td></tr>
              <tr><td>ddos_protect.maxflows</td><td>100</td><td>Maximum number of Flowspec rules allowed</td></tr>
              <tr><td>ddos_protect.externalgroup</td><td>external</td><td>Address group for external traffic</td></tr>
              <tr><td>ddos_protect.excludedgroups</td><td>external,private,multicast,exclude</td><td>Address groups to exclude as blackhole candidates</td></tr>
              <tr><td>ddos_protect.group.&lt;name&gt;</td><td></td><td>Set default for address group <em>name</em> to comma separated list of CIDRs</td></tr>
              <tr><td>ddos_protect.bgpgroup</td><td></td><td>Set group name for local addresses and use BGP to learn local / non-local CIDRs</td>
              <tr><td>ddos_protect.ip_flood.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.ip_flood.threshold</td><td>1000000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.ip_flood.timeout</td><td>180</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.ip_flood.include</td><td></td><td>Default list of IP protocols to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.ip_flood.exclude</td><td></td><td>Default list of IP protocols to exclude</td></tr>
              <tr><td>ddos_protect.ip_fragmentation.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.ip_fragmentation.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.ip_fragmentation.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.ip_fragmentation.include</td><td></td><td>Default list of IP protocols to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.ip_fragmentation.exclude</td><td></td><td>Default list of IP protocols to exclude</td></tr>
              <tr><td>ddos_protect.icmp_flood.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.icmp_flood.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.icmp_flood.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.icmp_flood.include</td><td></td><td>Default list of ICMP types to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.icmp_flood.exclude</td><td></td><td>Default list of ICMP types to exclude</td></tr>
              <tr><td>ddos_protect.tcp_amplification.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.tcp_amplification.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.tcp_amplification.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.tcp_amplification.include</td><td></td><td>Default list of TCP ports to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.tcp_amplification.exclude</td><td></td><td>Default list of TCP ports to exclude</td></tr> 
              <tr><td>ddos_protect.tcp_flood.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.tcp_flood.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.tcp_flood.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.tcp_flood.include</td><td></td><td>Default list of TCP ports to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.tcp_flood.exclude</td><td></td><td>Default list of TCP ports to exclude</td></tr>
              <tr><td>ddos_protect.udp_flood.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.udp_flood.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.udp_flood.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.udp_flood.include</td><td></td><td>Default list of UDP ports to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.udp_flood.exclude</td><td></td><td>Default list of UDP ports to exclude</td></tr>
              <tr><td>ddos_protect.udp_amplification.action</td><td>ignore</td><td>Default action: <em>ignore</em>, <em>drop</em>, <em>filter</em>, <em>mark</em>, or <em>limit</em></td></tr>
              <tr><td>ddos_protect.udp_amplification.threshold</td><td>500000</td><td>Default threshold (in Packets per Second)</td></tr>
              <tr><td>ddos_protect.udp_amplification.timeout</td><td>60</td><td>Default period to maintain action (in Minutes)</td></tr>
              <tr><td>ddos_protect.udp_amplification.include</td><td></td><td>Default list of UDP ports to include, empty list includes all</td></tr>
              <tr><td>ddos_protect.udp_amplification.exclude</td><td></td><td>Default list of UDP ports to exclude</td></tr>
              <tr><td>ddos_protect.mode</td><td>manual</td><td>Default mitgation mode: <em>manual</em> or <em>automatic</em></td></tr>
              <tr><td>ddos_protect.flow_seconds</td><td>2</td><td>Moving average used to smooth flow rates</td></tr>
              <tr><td>ddos_protect.threshold_seconds</td><td>60</td><td>Hold time for threshold before it will re-trigger</td></tr>
              <tr><td>ddos_protect.esr</td><td>no</td><td>Ignore event if there are insufficient samples for an accurate reading</td></tr>
              <tr><td>ddos_protect.esr_samples</td><td>15</td><td>Minimum number of samples required to trigger threshold</td></tr>
              <tr><td>ddos_protect.scf</td><td>no</td><td>Ignore event if there are too few traffic sources</td></tr>
              <tr><td>ddos_protect.scf_sources</td><td>10</td><td>Minimum number of traffic sources required to trigger threshold</td></tr>
              <tr><td>ddos_protect.syslog.host</td><td></td><td>Comma separated list of syslog collector IP addresses</td></tr>
              <tr><td>ddos_protect.syslog.port</td><td>514</td><td>UDP port for syslog events</td></tr>
              <tr><td>ddos_protect.syslog.facility</td><td>16</td><td>Syslog facility, default <em>local0</em></td></tr>
              <tr><td>ddos_protect.syslog.severity</td><td>5</td><td>Syslog severity, default <em>notice</em></td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
    <footer class="footer page-footer border-top mt-3">
       <div class="footer-copyright text-center py-2">
         <small class="text-muted">Copyright &copy; 2015-2022 InMon Corp. ALL RIGHTS RESERVED</small>
       </div>
    </footer>
  </body>
</html>
